php oil refine migrate:current --packages=kontiki
php oil refine migrate:up --packages=kontiki
delete from migration where 1 = 1;

//現在のコントローラ
'\\'.\Request::main()->controller
$controller = \Inflector::denamespace(\Request::main()->controller);
$controller = strtolower(substr($controller, 11));

//現在のアクション
$this->request->action

＊　＊　＊

actionsetの整理
destroyをいつか作る

＊　＊　＊

存在するコンテンツの時限装置の考案

■承認管理システム（いわゆるワークフロー）の実装相談
abstract controllerに
$this->is_workflowed
を設定。trueだったら、項目をワークフロー管理する
ワークフロー管理するコントローラには
- statusフィールド
必須とする。
$this->is_workflowed = true
なのに、このフィールドがないときにはエラーを出す

$this->is_workflowed = true
のコントローラは、フォームにstatusを変更できるスイッチがあったとしても、すべて無効になる。つまり編集者／承認者は項目の可視属性等をまったく変更できない。
statusはworkflowedかpublicのいずれかしか存在しない。

workflow管理下のコントローラでは、特殊なACLになる。
- ゲスト（一般公開。すべて承認されたコンテンツ。statusはpublic）
- 作成者（非公開。statusはworkflowed）
- 承認者（非公開。statusはworkflowed）


workflowコントローラを作る
workflowコントローラでは、経路設定ができる
最初に、承認ステップ数を決定する（ステップ数は最低2。1の場合は、自動的に承認される）

*workflows
id
name [XXセンター]

*workflow_steps
id
name [室長|事務局|事務局長....]
workflow_id
condition [and|or|atlease]
order

*workflow_step_actions
id
step_id
action [array(notice,mail)]

*workflow_allowers
step_id
user_id

*workflow_logs
id
workflow_id
controller
controller_id
current_step
status	[default|apply|rejected|remanded|finished]
comment
created_at
creator_id

